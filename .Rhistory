0.4, 1, 0, 1,  # right pannel with blur ratio
0, 0.06, 0.1, 0.5
),
nrow = 3,
byrow = TRUE
)
# testing layout screens
ss <- split.screen(figs = page_layout)
# matrix for layout
page_layout <- matrix(
c(
0.06, 0.4, 0, 0.55, # bottom left spectrogram
0.06, 0.4, 0.55, 1, # top left spectrogram
0.4, 1, 0, 1,  # right pannel with blur ratio
0, 0.06, 0.1, 0.6
),
nrow = 3,
byrow = TRUE
)
# testing layout screens
ss <- split.screen(figs = page_layout)
page_layout
# matrix for layout
page_layout <- matrix(
c(
0.06, 0.4, 0, 0.55, # bottom left spectrogram
0.06, 0.4, 0.55, 1, # top left spectrogram
0.4, 1, 0, 1,  # right pannel with blur ratio
0, 0.06, 0.1, 1
),
nrow = 4,
byrow = TRUE
)
# testing layout screens
ss <- split.screen(figs = page_layout)
for(i in 1:nrow(page_layout))
{screen(i)
par( mar = rep(0, 4))
plot(0.5, xlim = c(0,1), ylim = c(0,1), type = "n", axes = FALSE, xlab = "", ylab = "", xaxt = "n", yaxt = "n")
box()
text(x = 0.5, y = 0.5, labels = i)
}
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img()
a2 <- plot_blur_ratio(X = X, dest.path = tempdir()); last.img()
# styler::style_dir("./R")
#delete NAMESPACE file
unlink("./NAMESPACE")
#run document twice
devtools::document(".")
devtools::document(".")
#check with devtools
devtools::check(".", document = TRUE, run_dont_test = FALSE, vignettes = F)
# devtools::test()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
FUN <- "plot_degradation"
#run function
run.all()
source(file.path("./R", paste0(FUN, ".R")))
#open in rstudio
##open.fun(fun = FUN)
# remove objects but no functions
rm(list = setdiff(ls(), c(lsf.str(), "FUN")))
load("./data/degradation_est.rda")
options(sound.files.path = tempdir(), dest.path = tempdir())
# to troubleshoot internally
for(i in run.def.args(FUN)) try(eval(parse(text = i)), silent = T)
rm(i)
# source("https://raw.githubusercontent.com/maRce10/baRulho/master/R/plot_degradation.R")
#tests
try(dev.off())
X <- degradation_est[degradation_est$sound.files != "master.wav", ]
W <- set_reference_sounds(X)
# all spectros
plot_degradation(X = W, nrow = 4, mar = c(2, 1)); last.img(); rm.img()
# sorting by sound id
plot_degradation(X = W[order(W$sound.id, W$transect, decreasing = T), ], nrow = 4, mar = c(2, 1)); last.img(); rm.img()
# 1 transect
# R <- W[W$transect == W$transect[1], ]
try(dev.off(), silent = T)
# plot_degradation(X = R, nrow = 4, mar = c(2, 1)); last.img(); rm.img()
rm.img()
# removing one row
plot_degradation(X = W[-5, ], nrow = 3, ovlp = 95, colors = viridis::magma(4, alpha = 0.3), pal = viridis::magma); last.img(); rm.img()
plot_degradation(X = W[-3, ], nrow = 2, ovlp = 95, colors = viridis::mako(4, alpha = 0.4), pal = viridis::mako, wl = 200); last.img(); rm.img()
plot_degradation(X = W[-nrow(W), ], mar = c(3, 1), nrow = 4, ovlp = 95, colors = viridis::mako(4, alpha = 0.3)); last.img(); rm.img()
plot_degradation(X = W[-12, ], mar = c(5, 1), nrow = 6, ovlp = 95); last.img(); rm.img()
# changin marging
plot_degradation(X = W, mar = c(10, 1), nrow = 5, ovlp = 95); last.img(); rm.img()
# more rows than needed
plot_degradation(X = W,  nrow = 10, ovlp = 90); last.img(); rm.img()
# other colors
plot_degradation(X = W, nrow = 4, mar = c(2, 1), colors = viridis::magma(4, alpha = 0.3), pal = viridis::magma); last.img(); rm.img()
plot_degradation(X = W, nrow = 4, mar = c(2, 1), colors = viridis::plasma(n = 4, alpha = 0.1), pal = viridis::plasma); last.img(); rm.img()
# single row
plot_degradation(X = W[W$sound.id == "freq:9" & W$transect == "closed" | W$sound.id == "freq:9" & W$transect == "open" & W$distance == 1, ], nrow = 4, mar = c(2, 1), colors = viridis::plasma(n = 4, alpha = 0.1), pal = viridis::plasma); last.img(); rm.img()
print("using data frame and sound files")
playback_sels <- read.csv("./testing/example_data/aligned_test_sounds.csv")
playback_sels <- playback_sels[playback_sels$sound.id != "start_marker", ]
plot_degradation(X = playback_sels, nrow = 4, mar = c(2, 1), colors = viridis::mako(n = 4, alpha = 0.4), pal = viridis::viridis, path = "./testing/example_data/"); last.img(); rm.img()
W <- set_reference_sounds(ayback_sels)
plot_degradation(X = W, nrow = 4, mar = c(2, 1), colors = viridis::mako(n = 4, alpha = 0.4), pal = viridis::viridis, path = "./testing/example_data/"); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/plot_degradation.R")
source("https://raw.githubusercontent.com/maRce10/sketchy/main/R/load_packages.R")
x <- c("RColorBrewer", "devtools", "seewave", "testthat", github = "maRce10/warbleR", "monitoR", "pkgdown", "ape", "spelling", "ggplot2", "png", "viridis", "formatR", "kableExtra", github = "maRce10/ohun", "cli")
load_packages(x)
use_test()
# load example data
data("degradation_est")
# create subset of data with only re-recorded files
rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
source("~/Dropbox/R_package_testing/baRulho/R/set_reference_sounds.R")
source("~/Dropbox/R_package_testing/baRulho/R/set_reference_sounds.R")
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
# create subset of data with only re-recorded files
rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
source("https://raw.githubusercontent.com/maRce10/sketchy/main/R/load_packages.R")
x <- c("RColorBrewer", "devtools", "seewave", "testthat", github = "maRce10/warbleR", "monitoR", "pkgdown", "ape", "spelling", "ggplot2", "png", "viridis", "formatR", "kableExtra", github = "maRce10/ohun", "cli")
load_packages(x)
# load example data
data("degradation_est")
# create subset of data with only re-recorded files
rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
rerecorded_est
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
# styler::style_dir("./R")
#delete NAMESPACE file
unlink("./NAMESPACE")
#run document twice
devtools::document(".")
devtools::document(".")
#check with devtools
devtools::check(".", document = TRUE, run_dont_test = FALSE, vignettes = F)
# devtools::test()
# load example data
data("degradation_est")
# load example data
data("degradation_est")
# create subset of data with only re-recorded files
rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
source("~/Dropbox/R_package_testing/baRulho/R/set_reference_sounds.R")
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
rerecorded_est
# create plots
plot_blur_ratio(X = X, dest.path = tempdir())
# styler::style_dir("./R")
#delete NAMESPACE file
unlink("./NAMESPACE")
#run document twice
devtools::document(".")
devtools::document(".")
#check with devtools
devtools::check(".", document = TRUE, run_dont_test = FALSE, vignettes = F)
# devtools::test()
#     # load example data
#     data("degradation_est")
#
#     # create subset of data with only re-recorded files
#     rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
#
#     # add reference to X
#     X <- set_reference_sounds(X = rerecorded_est)
#
#     # create plots
plot_blur_ratio(X = X, dest.path = tempdir())
# load example data
data("degradation_est")
# create subset of data with only re-recorded files
rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
X = rerecorded_est
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
# create subset of data with only re-recorded files
rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
# create plots
plot_blur_ratio(X = X, dest.path = tempdir())
source("~/Dropbox/R_package_testing/baRulho/R/plot_blur_ratio.R")
# create plots
plot_blur_ratio(X = X, dest.path = tempdir())
source("~/Dropbox/R_package_testing/baRulho/R/plot_blur_ratio.R")
source("~/Dropbox/R_package_testing/baRulho/R/plot_blur_ratio.R")
# load example data
data("degradation_est")
# create subset of data with only re-recorded files
rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
# add reference to X
X <- set_reference_sounds(X = rerecorded_est)
# create plots
plot_blur_ratio(X = X, dest.path = tempdir())
# add reference to X
X <- set_reference_sounds(X = rerecorded_est[rerecorded_est$sound.id == rerecorded_est$sound.id[1], ])
rerecorded_est$sound.id[1]
rerecorded_est$sound.id[2]
# create subset of data with only re-recorded files
rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
# add reference to X
X <- set_reference_sounds(X = rerecorded_est[rerecorded_est$sound.id == rerecorded_est$sound.id[2], ])
# create plots
plot_blur_ratio(X = X, dest.path = tempdir())
# create plots
plot_blur_ratio(X = X, dest.path = tempdir(), pb = FALSE)
# create plots
plot_blur_ratio(X = X, dest.path = tempdir(), pb = FALSE)
fls <-
list.files(path = tempdir(),
pattern = "^blur_ratio",
full.names = TRUE)
fls
test_that("basic", {
# load example data
data("degradation_est")
# create subset of data with only re-recorded files
rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
# add reference to X
X <- set_reference_sounds(X = rerecorded_est[rerecorded_est$sound.id == rerecorded_est$sound.id[2], ])
# create plots
plot_blur_ratio(X = X, dest.path = tempdir(), pb = FALSE)
fls <-
list.files(path = tempdir(),
pattern = "^blur_ratio",
full.names = TRUE)
expect_length(fls, 16)
unlink(fls)
})
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
FUN <- "plot_blur_ratio"
#run function
run.all()
source(file.path("./R", paste0(FUN, ".R")))
#open in rstudio
##open.fun(fun = FUN)
# remove objects but no functions
rm(list = setdiff(ls(), c(lsf.str(), "FUN")))
load("./data/degradation_est.rda")
# to troubleshoot internally
for(i in run.def.args(FUN)) try(eval(parse(text = i)), silent = T)
rm(i)
#tests
X <- degradation_est[degradation_est$sound.files != "master.wav", ]
print("method 2")
X <- set_reference_sounds(X = X, method = 2)
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img()
source("~/Dropbox/R_package_testing/baRulho/R/plot_blur_ratio.R")
source("~/Dropbox/R_package_testing/baRulho/R/plot_blur_ratio.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10)); last.img(); rm.img()
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), flim = c(0, 10), colors = viridis(3)); last.img(); rm.img()
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(3)); last.img(); rm.img()
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = viridis(7)); last.img(); rm.img()
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = masko(3)); last.img(); rm.img()
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = mako(3)); last.img(); rm.img()
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = mako(3), palette = mako); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = mako(3), palette = mako); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = mako(3), palette = mako); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = mako(3), palette = mako); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = mako(3), palette = mako); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = mako(3), palette = mako); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = mako(3), palette = mako); last.img(); rm.img()
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), colors = mako(3), palette = magma); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/plot_blur_ratio.R")
X <- set_reference_sounds(X = X, method = 2)
a2 <- plot_blur_ratio(X = X, dest.path = tempdir()); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir()); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir()); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/plot_blur_ratio.R")
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
X <- set_reference_sounds(X = X, method = 2)
a2 <- plot_blur_ratio(X = X, dest.path = tempdir()); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir()); last.img(); rm.img()
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
par("usr")
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
adjustcolor("lightgray", 0.3)
adjustcolor("lightgray", 0.4)
adjustcolor("lightgray", 0.5)
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
adjustcolor("lightgray", 0.5)
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
warnings()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
warnings()
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), palette = reverse.gray.colors.2); last.img(); rm.img()
FUN <- "plot_blur_ratio"
#run function
run.all()
source(file.path("./R", paste0(FUN, ".R")))
#open in rstudio
##open.fun(fun = FUN)
# remove objects but no functions
rm(list = setdiff(ls(), c(lsf.str(), "FUN")))
load("./data/degradation_est.rda")
# to troubleshoot internally
for(i in run.def.args(FUN)) try(eval(parse(text = i)), silent = T)
rm(i)
#tests
X <- degradation_est[degradation_est$sound.files != "master.wav", ]
print("method 2")
X <- set_reference_sounds(X = X, method = 2)
a2 <- plot_blur_ratio(X = X, dest.path = tempdir()); last.img(); rm.img()
print("method 1 and spectrum")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), type = "spectrum"); last.img(); rm.img()
print("image is T")
a <- plot_blur_ratio(X = X, dest.path = tempdir()); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), type = "spectrum"); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), type = "spectrum"); last.img(); rm.img()
source("~/Dropbox/R_package_testing/baRulho/R/internal_functions.R")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), type = "spectrum"); last.img(); rm.img()
FUN <- "plot_blur_ratio"
#run function
run.all()
source(file.path("./R", paste0(FUN, ".R")))
#open in rstudio
##open.fun(fun = FUN)
# remove objects but no functions
rm(list = setdiff(ls(), c(lsf.str(), "FUN")))
load("./data/degradation_est.rda")
# to troubleshoot internally
for(i in run.def.args(FUN)) try(eval(parse(text = i)), silent = T)
rm(i)
#tests
X <- degradation_est[degradation_est$sound.files != "master.wav", ]
print("method 2")
X <- set_reference_sounds(X = X, method = 2)
a2 <- plot_blur_ratio(X = X, dest.path = tempdir()); last.img(); rm.img()
print("method 1 and spectrum")
a2 <- plot_blur_ratio(X = X, dest.path = tempdir(), type = "spectrum"); last.img(); rm.img()
print("image is T")
a <- plot_blur_ratio(X = X, dest.path = tempdir()); last.img(); rm.img()
print("using method 2 and env.smooth = 200")
b <- plot_blur_ratio(X = X, env.smooth = 200,  dest.path = tempdir()); last.img(); rm.img()
print("using method 2 no images")
a <- plot_blur_ratio(X = X,  collevels = seq(-40, 0, 5), pal = reverse.topo.colors,  dest.path = tempdir())
print("using method 1 and env.smooth = 200")
b <- plot_blur_ratio(X = X,  env.smooth = 250,  dest.path = tempdir(), wl = 250, ovlp = 95, res = 200); last.img(); rm.img()
print("using method 2 and env.smooth = 100,  no pb")
plot_blur_ratio(X = X,  env.smooth = 300, pb = FALSE,  dest.path = tempdir()); last.img(); rm.img()
print("include envelopes")
brs <- attributes(plot_blur_ratio(X = X, env.smooth = 300, envelopes = TRUE))$envelopes
print("using data frame and sound files")
playback_sels <- read.csv("./testing/example_data/aligned_test_sounds.csv")
X <- set_reference_sounds(playback_sels)
a <- plot_blur_ratio(X = X, path = "./testing/example_data/" ,wl = 512,  dest.path = tempdir()); last.img(); rm.img()
est <- selection_table(X = X, extended = TRUE, confirm.extended = FALSE, path = "./testing/example_data", mar = 0.2)
est$reference <- NULL
est <- set_reference_sounds(X = est)
a1 <- plot_blur_ratio(X = est, wl = 512,  dest.path = tempdir()); last.img(); rm.img()
cor(a$blur.ratio, a1$blur.ratio, use = "pairwise.complete.obs")
est_bs <- selection_table(X = X, extended = TRUE, confirm.extended = FALSE, path = "./testing/example_data", mar = 0.2, by.song = "sound.files")
est_bs$reference <- NULL
est_bs <- set_reference_sounds(X = est_bs)
a2 <- plot_blur_ratio(X = est_bs, wl = 512, img = T, dest.path = tempdir()); last.img(); rm.img()
a2 <- plot_blur_ratio(X = est_bs, wl = 512, dest.path = tempdir(), palette = mako); last.img(); rm.img()
# styler::style_dir("./R")
#delete NAMESPACE file
unlink("./NAMESPACE")
#run document twice
devtools::document(".")
devtools::document(".")
#check with devtools
devtools::check(".", document = TRUE, run_dont_test = FALSE, vignettes = F)
# devtools::test()
source("~/Dropbox/R_package_testing/baRulho/tests/testthat/test-plot_blur_ratio.R")
source("~/Dropbox/R_package_testing/baRulho/tests/testthat/test-plot_blur_ratio.R")
# load example data
data("degradation_est")
# create subset of data with only re-recorded files
rerecorded_est <- degradation_est[degradation_est$sound.files != "master.wav", ]
# add reference to X
X <- set_reference_sounds(X = rerecorded_est[rerecorded_est$sound.id == rerecorded_est$sound.id[2], ])
# create plots
plot_blur_ratio(X = X, dest.path = tempdir(), pb = FALSE)
fls <-
list.files(path = tempdir(),
pattern = "^blur_ratio",
full.names = TRUE)
expect_length(fls, 4)
unlink(fls)
# create plots
plot_blur_ratio(X = X, dest.path = tempdir(), pb = FALSE)
fls <-
list.files(path = tempdir(),
pattern = "^blur_ratio",
full.names = TRUE)
fls
# styler::style_dir("./R")
#delete NAMESPACE file
unlink("./NAMESPACE")
#run document twice
devtools::document(".")
devtools::document(".")
#check with devtools
devtools::check(".", document = TRUE, run_dont_test = FALSE, vignettes = F)
# devtools::test()
# styler::style_dir("./R")
#delete NAMESPACE file
unlink("./NAMESPACE")
#run document twice
devtools::document(".")
devtools::document(".")
#check with devtools
devtools::check(".", document = TRUE, run_dont_test = FALSE, vignettes = F)
# devtools::test()
