<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fix misaligned start and end of test sounds — realign_test_sounds • baRulho</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Fix misaligned start and end of test sounds — realign_test_sounds" />
<meta property="og:description" content="realign_test_sounds fixes misaligned start and end of test sounds in an extended selection table using spectrographic cross-correlation" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">baRulho</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/baRulho.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/maRce10/baRulho/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fix misaligned start and end of test sounds</h1>
    <small class="dont-index">Source: <a href='https://github.com/maRce10/baRulho/blob/master/R/realign_test_sounds.R'><code>R/realign_test_sounds.R</code></a></small>
    <div class="hidden name"><code>realign_test_sounds.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>realign_test_sounds</code> fixes misaligned start and end of test sounds in an extended selection table using spectrographic cross-correlation</p>
    </div>

    <pre class="usage"><span class='fu'>realign_test_sounds</span><span class='op'>(</span><span class='va'>X</span>, parallel <span class='op'>=</span> <span class='fl'>1</span>, cores <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"mc.cores"</span>, <span class='fl'>1</span><span class='op'>)</span>, 
pb <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"pb"</span>, <span class='cn'>TRUE</span><span class='op'>)</span>, hop.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"hop.size"</span>, <span class='fl'>11.6</span><span class='op'>)</span>, 
wl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"wl"</span>, <span class='cn'>NULL</span><span class='op'>)</span>, ovlp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"ovlp"</span>, <span class='fl'>90</span><span class='op'>)</span>, wn <span class='op'>=</span> <span class='st'>'hanning'</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>object of class 'extended_selection_table' created by the function <code><a href='https://marce10.github.io/warbleR/reference/selection_table.html'>selection_table</a></code> from the warbleR package. The object must include the following additional columns: 'sound.id', 'bottom.freq' and 'top.freq'.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>DEPRECATED. Use 'cores' instead.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>Numeric vector of length 1. Controls whether parallel computing is applied by specifying the number of cores to be used. Default is 1 (i.e. no parallel computing).</p></td>
    </tr>
    <tr>
      <th>pb</th>
      <td><p>Logical argument to control if progress bar is shown. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>hop.size</th>
      <td><p>A numeric vector of length 1 specifying the time window duration (in ms). Default is 11.6 ms, which is equivalent to 512 wl for a 44.1 kHz sampling rate. Ignored if 'wl' is supplied.</p></td>
    </tr>
    <tr>
      <th>wl</th>
      <td><p>A numeric vector of length 1 specifying the window length of the spectrogram, default 
is NULL. If supplied, 'hop.size' is ignored.</p></td>
    </tr>
    <tr>
      <th>ovlp</th>
      <td><p>Numeric vector of length 1 specifying % of overlap between two 
consecutive windows, as in <code><a href='https://rdrr.io/pkg/seewave/man/spectro.html'>spectro</a></code>. Default is 90. High values of ovlp 
slow down the function but produce more accurate results.</p></td>
    </tr>
    <tr>
      <th>wn</th>
      <td><p>A character vector of length 1 specifying the window name as in <code><a href='https://rdrr.io/pkg/seewave/man/ftwindow.html'>ftwindow</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame, or extended selection table similar to input data (depending on argument 'output') in which time parameters (columns 'start' and 'end') have been tailored to more closely match the start and end of the reference sound.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function uses spectrographic cross-correlation to align the position in time of sounds with regard to a reference sound. The sound recorded at the closest distance to the source is used as reference. Precise alignment is crucial for downstream measures of sound degradation. The function calls warbleR's <code><a href='https://marce10.github.io/warbleR/reference/cross_correlation.html'>cross_correlation</a></code> internally to align sounds using cross-correlation. The output extended selection table contains the new start and end values after alignment.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Araya-Salas, M. (2020). baRulho: baRulho: quantifying habitat-induced degradation of (animal) acoustic signals in R. R package version 1.0.2Clark, C.W., Marler, P. &amp; Beeman K. (1987). Quantitative analysis of animal vocal phonology: an application to Swamp Sparrow song. Ethology. 76:101-115.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='blur_ratio.html'>blur_ratio</a></code>, <code><a href='https://marce10.github.io/warbleR/reference/cross_correlation.html'>cross_correlation</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Marcelo Araya-Salas (<a href='mailto:marcelo.araya@ucr.ac.cr'>marcelo.araya@ucr.ac.cr</a>)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='op'>{</span>
<span class='co'># load example data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"playback_est_unaligned"</span><span class='op'>)</span>

<span class='co'># method 1</span>
<span class='fu'>realign_test_sounds</span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>playback_est_unaligned</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'><span style='color: #000000;'>running cross-correlation (step 1 of 2):</span></span></div><div class='output co'>#&gt;   |                                                  | 0 % ~calculating    |+++++++++                                         | 17% ~00s            |+++++++++++++++++                                 | 33% ~00s            |+++++++++++++++++++++++++                         | 50% ~00s            |++++++++++++++++++++++++++++++++++                | 67% ~00s            |++++++++++++++++++++++++++++++++++++++++++        | 83% ~00s            |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=00s  
#&gt; finding peaks and aligning (step 2 out of 2)
#&gt;   |                                                  | 0 % ~calculating    |+++++++++                                         | 17% ~00s            |+++++++++++++++++                                 | 33% ~00s            |+++++++++++++++++++++++++                         | 50% ~00s            |++++++++++++++++++++++++++++++++++                | 67% ~00s            |++++++++++++++++++++++++++++++++++++++++++        | 83% ~00s            |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=00s  </div><div class='output co'>#&gt; <span class='message'><span style='color: #000000;'>Object of class </span><span style='color: #000000; font-weight: bold;'>'extended_selection_table'</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>* The output of the following call:</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555; font-style: italic;'>realign_test_sounds(X = playback_est_unaligned)</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555; font-weight: bold;'></span>
#&gt; <span class='message'>Contains:</span><span style='color: #555555;'> </span>
#&gt; <span class='message'>*  A selection table data frame with 8 row(s) and 8 columns:</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|   |sound.files    | selec|  start|    end| bottom.freq| top.freq|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|:--|:--------------|-----:|------:|------:|-----------:|--------:|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|5  |01m_re-rec.wav |     4| 1.0500| 1.2445|      1.5441|  10.8946|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|6  |05m_re-rec.wav |     4| 1.0477| 1.2422|      1.5441|  10.8946|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|7  |10m_re-rec.wav |     4| 1.0419| 1.2363|      1.5441|  10.8946|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|8  |15m_re-rec.wav |     4| 1.0419| 1.2363|      1.5441|  10.8946|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|21 |01m_re-rec.wav |     2| 0.5500| 0.7001|      1.7436|  11.0500|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|22 |05m_re-rec.wav |     2| 0.5465| 0.6966|      1.7436|  11.0500|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>... 2 more column(s) (distance, sound.id)</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'> and 2 more row(s)</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'></span>
#&gt; <span class='message'>* 4 wave object(s) (as attributes): </span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>01m_re-rec.wav05m_re-rec.wav10m_re-rec.wav15m_re-rec.wav</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'></span>
#&gt; <span class='message'>* A data frame (check.results) generated by check_sels() (as attribute)</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555; font-weight: bold;'></span>
#&gt; <span class='message'>Additional information:</span><span style='color: #555555;'></span>
#&gt; <span class='message'>* The selection table was created</span><span style='color: #555555; font-weight: bold; font-style: italic;'> by song </span><span style='color: #555555;'>(see 'class_extended_selection_table')</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>* 1 sampling rate(s) (in kHz): </span><span style='color: #555555; font-weight: bold;'>22.1</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>* 1 bit depth(s): </span><span style='color: #555555; font-weight: bold;'>8</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>* Created by warbleR &lt; 1.1.21</span></span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Marcelo Araya-Salas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


