<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Measure detection distance of sound — detection_distance • baRulho</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Measure detection distance of sound — detection_distance" />
<meta property="og:description" content="detection_distance detection distance of sounds." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">baRulho</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/baRulho.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/maRce10/baRulho/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Measure detection distance of sound</h1>
    <small class="dont-index">Source: <a href='https://github.com/maRce10/baRulho/blob/master/R/detection_distance.R'><code>R/detection_distance.R</code></a></small>
    <div class="hidden name"><code>detection_distance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>detection_distance</code> detection distance of sounds.</p>
    </div>

    <pre class="usage"><span class='fu'>detection_distance</span><span class='op'>(</span><span class='va'>X</span>, cores <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"mc.cores"</span>, <span class='fl'>1</span><span class='op'>)</span>, 
pb <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"pb"</span>, <span class='cn'>TRUE</span><span class='op'>)</span>, output <span class='op'>=</span> <span class='st'>"est"</span>, 
hop.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"hop.size"</span>, <span class='fl'>11.6</span><span class='op'>)</span>, wl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"wl"</span>, <span class='cn'>NULL</span><span class='op'>)</span>, 
path <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"sound.files.path"</span>, <span class='st'>"."</span><span class='op'>)</span>, spl <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>spl.cutoff</span>, temp <span class='op'>=</span> <span class='fl'>20</span>, 
rh <span class='op'>=</span> <span class='fl'>60</span>, pa <span class='op'>=</span> <span class='fl'>101325</span>, hab.att.coef <span class='op'>=</span> <span class='fl'>0.02</span>, max.distance <span class='op'>=</span> <span class='fl'>1000</span>,
resolution <span class='op'>=</span> <span class='fl'>0.1</span>, subtract.bgn <span class='op'>=</span> <span class='cn'>TRUE</span>, envelope <span class='op'>=</span> <span class='st'>"abs"</span>, mar <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>Object of class 'data.frame', 'selection_table' or 'extended_selection_table' (the last 2 classes are created by the function <code><a href='https://marce10.github.io/warbleR/reference/selection_table.html'>selection_table</a></code> from the warbleR package) with the reference to the sounds in the master sound file. Must contain the following columns: 1) "sound.files": name of the .wav files, 2) "selec": unique selection identifier (within a sound file), 3) "start": start time and 4) "end": end time of selections, 5)  "bottom.freq": low frequency for bandpass, 6) "top.freq": high frequency for bandpass and 7) "sound.id": ID of sounds used to identify counterparts across distances. Each sound must have a unique ID within a distance.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>Numeric vector of length 1. Controls whether parallel computing is applied by specifying the number of cores to be used. Default is 1 (i.e. no parallel computing).</p></td>
    </tr>
    <tr>
      <th>pb</th>
      <td><p>Logical argument to control if progress bar is shown. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>Character vector of length 1 to determine if an extended selection table ('est', default) or a data frame ('data.frame').</p></td>
    </tr>
    <tr>
      <th>hop.size</th>
      <td><p>A numeric vector of length 1 specifying the time window duration (in ms). Default is 11.6 ms, which is equivalent to 512 wl for a 44.1 kHz sampling rate. Ignored if 'wl' is supplied.</p></td>
    </tr>
    <tr>
      <th>wl</th>
      <td><p>A numeric vector of length 1 specifying the window length of the spectrogram, default
is <code>NULL</code>. If supplied, 'hop.size' is ignored.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>Character string containing the directory path where the sound files are found. Only needed when 'X' is not an extended selection table.</p></td>
    </tr>
    <tr>
      <th>spl</th>
      <td><p>A numeric vector of length 1 specifying the sound pressure level of sounds. If not supplied then it will be measured from the sounds  themselves.</p></td>
    </tr>
    <tr>
      <th>spl.cutoff</th>
      <td><p>A numeric vector of length 1 specifying the sound pressure level cutoff to define if the sound is no longer detected. Ideally it should be estimated based on the sound detection threshold of the species.</p></td>
    </tr>
    <tr>
      <th>temp</th>
      <td><p>Numeric vector of length 1 with frequency (in Celsius). Default is 20.</p></td>
    </tr>
    <tr>
      <th>rh</th>
      <td><p>Numeric vector of length 1 with relative humidity (in percentage). Default is 60.</p></td>
    </tr>
    <tr>
      <th>pa</th>
      <td><p>Numeric vector of length 1 with ambient pressure in Pa (standard: 101325, default). Used for Atmospheric attenuation.</p></td>
    </tr>
    <tr>
      <th>hab.att.coef</th>
      <td><p>Attenuation coefficient of the habitat (in dB/kHz/m).</p></td>
    </tr>
    <tr>
      <th>max.distance</th>
      <td><p>Numeric vector of length 1 with the maximum distance (in m) at which detection would be evaluated. Note that the function calculates the expected sound pressure level values along a vector of distances to find the distance at which the expected sound pressure level equates 'spl.cutoff'. Default is 1000 m.</p></td>
    </tr>
    <tr>
      <th>resolution</th>
      <td><p>NUmeric vector of length 1 with the distance resolution (in m) for estimated detection distance. Higher resolutions take longer to estimate. Default is 0.1 m.</p></td>
    </tr>
    <tr>
      <th>subtract.bgn</th>
      <td><p>Logical argument to control if SPL from background noise is excluded from the measured signal SPL. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>envelope</th>
      <td><p>Character string vector with the method to calculate amplitude envelopes (in which SPL is measured, used required if 'spl' is not supplied), as in <code><a href='https://rdrr.io/pkg/seewave/man/env.html'>env</a></code>. Must be either 'abs' (absolute envelope, default) or 'hil' (Hilbert transformation).</p></td>
    </tr>
    <tr>
      <th>mar</th>
      <td><p>numeric vector of length 1. Specifies the margins adjacent to
the start and end points of selection over which to measure background noise. This is required to subtract background noise sound pressure level (so only needed when 'subtract.bgn = TRUE').</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns the geometric, atmospheric and habitat attenuation (in dB) as well as the combined attenuation.</p>
<p>A data frame, or extended selection table similar to input data (depending on argument 'output'), but including two new columns (reference and detection.distance).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function computes the maximum distance at which a sound would be detected, which is calculated as the distance in which the sound pressure level (SPL) goes below the specified SPL cutoff ('spl.cutoff')). The function uses internally <code><a href='attenuation.html'>attenuation</a></code> to estimate SPL at increasing values until it reaches the defined cutoff. The peak frequency (calculated on the power spectrum of the reference sound) of the reference sound for each sound ID is used as the carrier frequency for distance estimation. The sound recorded at the lowest distance is used as reference. <strong>This function assumes that all recordings have been made at the same recording volume</strong>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Araya-Salas, M. (2020). baRulho: baRulho: quantifying habitat-induced degradation of (animal) acoustic signals in R. R package version 1.0.2Clark, C.W., Marler, P. &amp; Beeman K. (1987). Quantitative analysis of animal vocal phonology: an application to Swamp Sparrow song. Ethology. 76:101-115.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='attenuation.html'>attenuation</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Marcelo Araya-Salas (<a href='mailto:marcelo.araya@ucr.ac.cr'>marcelo.araya@ucr.ac.cr</a>)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='op'>{</span>
<span class='co'># load example data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"playback_est"</span><span class='op'>)</span>

<span class='fu'>detection_distance</span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>playback_est</span><span class='op'>[</span><span class='va'>playback_est</span><span class='op'>$</span><span class='va'>distance</span> <span class='op'>==</span> <span class='fl'>1</span>,<span class='op'>]</span>, spl.cutoff <span class='op'>=</span> <span class='fl'>5</span>, mar <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; Preparing data for analysis (step 1 out of 3):
#&gt;   |                                                  | 0 % ~calculating    |++++++++                                          | 14% ~00s            |+++++++++++++++                                   | 29% ~00s            |++++++++++++++++++++++                            | 43% ~00s            |+++++++++++++++++++++++++++++                     | 57% ~00s            |++++++++++++++++++++++++++++++++++++              | 71% ~00s            |+++++++++++++++++++++++++++++++++++++++++++       | 86% ~00s            |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=00s  
#&gt; Computing sound pressure level and peak frequency (step 2 out of 3):
#&gt;   |                                                  | 0 % ~calculating    |++++++++                                          | 14% ~00s            |+++++++++++++++                                   | 29% ~00s            |++++++++++++++++++++++                            | 43% ~00s            |+++++++++++++++++++++++++++++                     | 57% ~00s            |++++++++++++++++++++++++++++++++++++              | 71% ~00s            |+++++++++++++++++++++++++++++++++++++++++++       | 86% ~00s            |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=00s  
#&gt; Computing detection distance (step 3 out of 3):
#&gt;   |                                                  | 0 % ~calculating    |++++++++                                          | 14% ~00s            |+++++++++++++++                                   | 29% ~00s            |++++++++++++++++++++++                            | 43% ~00s            |+++++++++++++++++++++++++++++                     | 57% ~00s            |++++++++++++++++++++++++++++++++++++              | 71% ~00s            |+++++++++++++++++++++++++++++++++++++++++++       | 86% ~00s            |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=00s  </div><div class='output co'>#&gt; <span class='message'><span style='color: #000000;'>Object of class </span><span style='color: #000000; font-weight: bold;'>'extended_selection_table'</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>* The output of the following call:</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555; font-style: italic;'>detection_distance(X = playback_est[playback_est$distance ==  1, ], spl.cutoff = 5, mar = 0.05)</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555; font-weight: bold;'></span>
#&gt; <span class='message'>Contains:</span><span style='color: #555555;'> </span>
#&gt; <span class='message'>*  A selection table data frame with 7 row(s) and 10 columns:</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|   |sound.files    | selec| start|    end| bottom.freq| top.freq|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|:--|:--------------|-----:|-----:|------:|-----------:|--------:|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|1  |01m_re-rec.wav |     1| 0.050| 0.2073|      2.2387|  11.5892|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|5  |01m_re-rec.wav |     4| 1.050| 1.2445|      1.5441|  10.8946|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|9  |01m_re-rec.wav |     5| 1.550| 1.6815|      2.3770|  11.7275|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|13 |01m_re-rec.wav |     3| 0.798| 0.9553|      2.2387|  11.5892|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|17 |01m_re-rec.wav |     6| 1.765| 1.9223|      2.2387|  11.5892|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>|21 |01m_re-rec.wav |     2| 0.550| 0.7001|      1.7436|  11.0941|</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>... 4 more column(s) (distance, sound.id, reference, detection.distance)</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'> and 1 more row(s)</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'></span>
#&gt; <span class='message'>* 1 wave object(s) (as attributes): </span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>01m_re-rec.wav</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'></span>
#&gt; <span class='message'>* A data frame (check.results) generated by check_sels() (as attribute)</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555; font-weight: bold;'></span>
#&gt; <span class='message'>Additional information:</span><span style='color: #555555;'></span>
#&gt; <span class='message'>* The selection table was created</span><span style='color: #555555; font-weight: bold; font-style: italic;'> by song </span><span style='color: #555555;'>(see 'class_extended_selection_table')</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>* 1 sampling rate(s) (in kHz): </span><span style='color: #555555; font-weight: bold;'>44.1</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>* 1 bit depth(s): </span><span style='color: #555555; font-weight: bold;'>8</span></span></div><div class='output co'>#&gt; <span class='message'><span style='color: #555555;'>* Created by warbleR &lt; 1.1.21</span></span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Marcelo Araya-Salas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


